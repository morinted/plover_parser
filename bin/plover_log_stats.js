#!/usr/bin/env node
!function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.oe=function(r){throw r},e.p="",e(e.s=4)}([function(r,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.exit=function(r){r&&console.error("ERROR: "+r),process.exit()}},function(r,e,t){"use strict";function n(r){return Array.isArray(r)?r:Array.from(r)}var o=function(){function r(r,e){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=r[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!e||t.length!==e);n=!0);}catch(c){o=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=t(2),u=t(0),a="Usage: plover_log_stats plover.log plover.log.1 [...] plover.log.n",c=process.argv.slice(2),l=n(c),s=l;s.length<1&&(0,u.exit)("Must provide list of logs as arguments.\n\n"+a);var f=(0,i.readLogFiles)(s);console.info("Loaded "+f.length+" translation outputs from the logs.");var d=f.reduce(function(r,e){var t=o(e,2),n=t[0],i=t[1];return r[i]||(r[i]={}),r[i][n]?r[i][n]+=1:r[i][n]=1,r},{}),p=Object.keys(d).sort(function(r,e){var t=Object.keys(d[r]).reduce(function(e,t){return e+d[r][t]},0),n=Object.keys(d[e]).reduce(function(r,t){return r+d[e][t]},0);return n-t}),g=p.map(function(r){return d[r]&&"None"!==r?r+": "+Object.keys(d[r]).reduce(function(e,t){return""+(e?e+", ":"")+t+" ("+d[r][t]+")"},""):void 0}).filter(function(r){return r}),y=function(){return"\nShowing "+g.length+" unique words.\n"};console.log(y()),console.log(g.join("\n")),console.log(y())},function(r,e,t){"use strict";function n(r){return r&&r.__esModule?r:{"default":r}}Object.defineProperty(e,"__esModule",{value:!0}),e.readLogFiles=e.readWordList=e.readLogFile=void 0;var o=t(3),i=n(o),u=t(0),a=e.readLogFile=function(r){try{return i["default"].readFileSync(r,"utf8").split("\n").filter(function(r){return r.includes(" Translation(")}).map(function(r){var e=void 0,t=void 0;try{e=JSON.parse("[ "+r.match(/Translation\(\(([^\)]+)\)/)[1].replace(/'/g,'"').replace(/,$/,"").replace(/u/g,"")+" ]").map(function(r){return r.match(/^[STKPWHR]+$/)?r+"-":r}).join("/")}catch(n){(0,u.exit)("Can't process key in entry \""+r+'"')}try{t=r.match(/\) : ([^)]+)\)/)[1]}catch(n){(0,u.exit)("Can't process translation in entry \""+r+'"')}return[e,t]})}catch(e){(0,u.exit)("Problem reading "+r+": "+e.message)}};e.readWordList=function(r,e){try{var t=e?r:i["default"].readFileSync(r,"utf8"),n=t.replace(/\r\n/g,/\n/).split("\n").filter(function(r){return r}),o=n.reduce(function(r,e,t){return r[e]=t+1,r},{});return[n,o]}catch(a){(0,u.exit)("Error loading wordlist: '"+(e?"default wordlist":r)+"'. Please ensure 1 word per line, UTF-8 format.")}},e.readLogFiles=function(r){return[].concat.apply([],r.map(function(r){return a(r)}))}},function(r,e){r.exports=require("fs")},function(r,e,t){r.exports=t(1)}]);